const getURL=async()=>{let t=document.getElementById("inputURL").value;if(!t)return void Swal.fire({toast:!0,position:"top-end",icon:"warning",title:"لطفاً یک لینک وارد کنید!",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,customClass:{popup:"pastel-warning"}});const e=document.querySelector('meta[name="shorten-url"]').getAttribute("content"),o={method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({original_url:t})};try{let t=await fetch(e,o),r=await t.json();if(t.ok){Swal.fire({toast:!0,position:"top-end",icon:"success",title:"لینک کوتاه شد!",text:`لینک شما: ${r.short_url}`,showConfirmButton:!0,confirmButtonText:"کپی لینک",timer:5e3,timerProgressBar:!0,customClass:{popup:"pastel-success"}}).then((t=>{t.isConfirmed&&(navigator.clipboard.writeText(r.short_url),Swal.fire({toast:!0,position:"top-end",icon:"success",title:"کپی شد!",text:"لینک در کلیپ‌بورد ذخیره شد.",showConfirmButton:!1,timer:1500,timerProgressBar:!0,customClass:{popup:"pastel-success"}}))}));const t=document.querySelector(".result-container");console.log(r);const e=document.createElement("div");e.classList.add("result"),e.style.cssText="direction: rtl; display: flex; align-items: center; gap: 10px; background: #f9f9f9; padding: 10px; border: 1px solid #ddd; border-radius: 8px; position: relative;",e.id=`link-${r.id}`,e.innerHTML=`\n                لینک:\n                <span class="tooltip-container" style="position: relative; cursor: pointer;">\n                    <span style="color: blue; text-decoration: underline;">  ${r.original_url}</span>\n                </span>\n       \n                <button class="copy-btn" onclick="deleteLink(event, '/link/${r.short_url}/delete', '${r.id}')">\n                    <i class="fas fa-trash" style="color: red;"></i>\n                </button>\n            `,t.prepend(e)}else{let t="خطایی رخ داده است. لطفاً دوباره امتحان کنید.";r.errors&&(t=Object.values(r.errors).flat().join("\n")),Swal.fire({toast:!0,position:"top-end",icon:"error",title:"خطا!",text:t,showConfirmButton:!1,timer:3e3,timerProgressBar:!0,customClass:{popup:"pastel-error"}})}}catch(t){Swal.fire({toast:!0,position:"top-end",icon:"error",title:"مشکلی پیش آمد!",text:"اتصال به سرور برقرار نشد. لطفاً بعداً تلاش کنید.",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,customClass:{popup:"pastel-error"}})}},copyToClipboard=t=>{navigator.clipboard.writeText(t).then((()=>{Swal.fire({toast:!0,position:"top-end",icon:"success",title:"لینک کپی شد!",text:"لینک در کلیپ‌بورد شما ذخیره شد.",showConfirmButton:!1,timer:2e3,timerProgressBar:!0,customClass:{popup:"pastel-success"}})})).catch((t=>{Swal.fire({toast:!0,position:"top-end",icon:"error",title:"خطا!",text:"متأسفیم، کپی لینک انجام نشد.",showConfirmButton:!1,timer:2e3,timerProgressBar:!0,customClass:{popup:"pastel-error"}})}))};document.querySelectorAll(".tooltip-container").forEach((t=>{t.addEventListener("mouseover",(()=>{t.querySelector(".tooltip").style.visibility="visible"})),t.addEventListener("mouseout",(()=>{t.querySelector(".tooltip").style.visibility="hidden"}))}));const deleteLink=async(t,e,o)=>{t.preventDefault();if((await Swal.fire({title:"آیا از حذف این لینک مطمئن هستید؟",text:"این عملیات قابل بازگشت نیست!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",customClass:{popup:"pastel-success"},cancelButtonColor:"#3085d6",confirmButtonText:"بله، حذف شود!",cancelButtonText:"لغو"})).isConfirmed)try{if((await fetch(e,{method:"DELETE",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),"Content-Type":"application/json"}})).ok){const t=document.getElementById(`link-${o}`);t.style.transition="all 0.4s ease",t.style.opacity="0",setTimeout((()=>t.remove()),400),Swal.fire({toast:!0,position:"top-end",icon:"success",title:"لینک حذف شد!",showConfirmButton:!1,timer:2e3,timerProgressBar:!0,customClass:{popup:"pastel-success"}})}else Swal.fire({icon:"error",title:"خطا!",text:"مشکلی در حذف لینک رخ داد. لطفاً دوباره امتحان کنید.",showConfirmButton:!1,timer:3e3})}catch(t){Swal.fire({icon:"error",title:"خطای سرور!",text:"ارتباط با سرور برقرار نشد. لطفاً بعداً تلاش کنید.",showConfirmButton:!1,timer:3e3})}};